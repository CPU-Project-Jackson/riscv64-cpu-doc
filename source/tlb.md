# 虚拟存储器

基本思想是对于一个程序来说，他的程序、数据和堆栈的总大小可以超过实际的物理内存。主存可以为通常由磁盘实现的辅助存储充当“cache”，这种技术被称为虚拟存储。

从历史上看，提出虚拟存储的主要动机有两个：
1. 允许在多个程序之间高校安全地共享内存，例如云计算的多个虚拟机所需的内存
2. 消除小而受限的主存容量对程序设计造成的影响。

50年后，第一条变成了主要设计动机。

## 基础知识

如果使用了虚拟地址，则处理器输出的地址就是虚拟地址了，这个地址不会被直接送到物理存储器中，而是需要先进行地址转换，因为虚拟地址是没有办法直接寻址物理存储器的。负责地址转换的部件一般称为内存管理单元(Memory control unit,MMU)

```{caution}
需要注意的是，操作系统本身也需要指令和数据，但是考虑到他需要能够访问物理内存中所有的空间，**所以操作系统一般不会使用页表**，而是直接可以访问物理内存，在物理内存中有一部分地址范围专门供操作系统使用，不允许别的进程随便地访问它，例如在32位MIPS处理器中，将整个4GB虚拟存储空间分为了kseg0、kseg1、kseg2和kuseg共四个区域，其中kseg0区域的属性是unmapped，也就是说，这部分地址是不需要经过页表进行转换的，操作系统内核的指令和数据就是位于kseg0区域。
```


TLB不同于一般的Cache，他只有时间相关性。

## 动手实践
